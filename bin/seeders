#!/usr/bin/php
<?php declare(strict_types=1);

use LeanPHP\Container;
use LeanPHP\Database\RunSeedersCommand;

$options = getopt('', ['env:']);
if (is_array($options) && isset($options['env'])) {
    define('APP_ENV_OVERRIDE', $options['env']);
}

require __DIR__ . '/../bootstrap/app.php';
assert(isset($container) && $container instanceof Container);

$command = $container->get(RunSeedersCommand::class);

$firstArg = null;
array_shift($argv);
foreach ($argv as $arg) {
    if (!str_starts_with($arg, '-')) {
        $firstArg = $arg;
        break;
    }
}

$status = $command->run($firstArg);

exit($status);